<div class="title-wrapper pt-30">
  <div class="title mb-30">
    <h1><%= @case_contact.decorate.draft_state %> Case Contact</h1>
  </div>
</div>

<%= render "progress_bar" %>

<div>
  <%= form_with(model: @case_contact, url: wizard_path(nil, case_contact_id: @case_contact.id), local: true, id: "casa-contact-form", class: "component-validated-form") do |form| %>
    <%= render "/shared/error_messages", resource: @case_contact %>

    <div class="card-style-1 pl-25 mb-10">
      <h4 class="mb-20"><label for="case_contact_casa_case">1. Select the relevant <%= "case".pluralize(@casa_cases.count) %> for this contact <span class="red-letter">*</span></label></h4>
      <div class="casa-case-scroll">
        <% @casa_cases.each do |casa_case| %>
          <div class="form-check checkbox-style mb-10 ml-5">
            <%= check_box_tag "case_contact[draft_case_ids][]",
              casa_case.id,
              @case_contact.draft_case_ids.include?(casa_case.id),
              id: "case_contact_draft_case_id_#{casa_case.id}",
              class: ["form-check-input", "casa-case-id"] %>
            <label class="form-check-label" for="case_contact_draft_case_id_<%= casa_case.id %>">
              <%= casa_case.case_number %>
            </label>
          </div>
        <% end %>
      </div>
    </div>
    <div class="card-style-1 pl-25 mb-10">
      <%= render "contact_types",
        form: form,
        model: @case_contact,
        contact_type_groups:  @current_organization_groups,
        selected_case_contact_types: @selected_case_contact_types,
        checkbox_tag_name: "case_contact[case_contact_contact_type_attributes][][contact_type_id]" %>
    </div>

    <div class="actions mb-10">
      <%= link_to previous_wizard_path(case_contact_id: @case_contact.id), class: "btn-sm main-btn secondary-btn-outline btn-hover" do %>
        <i class="lni lni-arrow-left mr-5"></i> Previous
      <% end %>

      <%= button_tag( type: "submit" , class: "btn-sm main-btn primary-btn btn-hover" ) do %>
        <i class="lni lni-arrow-right mr-5"></i> Continue
      <% end %>
    </div>
  <% end %>
</div>